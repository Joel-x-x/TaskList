const taskBox=document.querySelector("#caja-tarea"),searchInput=document.querySelector("#search"),taskContain=document.querySelector(".contenedor-tareas"),completedContain=document.querySelector(".contenedor-completadas"),btnAgregar=document.querySelector(".boton-agregar"),btnToggle=document.getElementById("toggle"),deleteTasks=document.getElementById("delete-all");let taskInstance,taskContent=[],iteradorTaskContent=0,contadorTag=0;function startApp(){chargeData()?(chargeData().forEach(e=>{var{text:e,tag:t,check:a,id:n}=e;taskContent[iteradorTaskContent]=new Task(e,t,a,n),taskContent[iteradorTaskContent].createHTML(),iteradorTaskContent++}),hideMessage(".any-completed",completedContain),hideMessage(".any-task",taskContain)):(hideMessage(".any-task",taskContain),hideMessage(".any-completed",completedContain))}function pressEnter(e){13!==e.which&&13!==e.keyCode&&"Enter"!==e.key||(e.preventDefault(),createTask())}function createTask(){""==taskBox.value.trim()?taskBox.value="":(taskContent[iteradorTaskContent]=new Task(taskBox.value.trim()),taskContent[iteradorTaskContent].createHTML(),iteradorTaskContent++,taskBox.value="",saveData(),hideMessage(".any-task",taskContain))}function focusEvent(e){47!==e.which&&47!==e.keyCode&&"/"!==e.key||(e.preventDefault(),buscador.classList.contains("click")?searchInput.blur():searchInput.focus()),13!==e.which&&13!==e.keyCode&&"Enter"!==e.key||(e.preventDefault(),taskBox.focus())}function modifytaskBox(e){e.target.classList.contains("contenedor-tareas")||updateHTML(e.target.parentElement.id,e.target.id)}function updateHTML(t,a){taskContent.forEach(e=>{if(e.id==t)switch(a){case"icon-close":deleteTask(t);break;case"card-task":updateTask(t);break;case"tag":modifyTag(t);break;case"boton-check":taskCompleted(t)}}),saveData()}function deleteTask(t){var e=taskContent.filter(e=>e.id!=t);taskContent=[...e],iteradorTaskContent--,saveData(),document.getElementById(t).remove(),hideMessage(".any-task",taskContain),hideMessage(".any-completed",completedContain)}function updateTask(a){taskContent.forEach(e=>{var t=document.getElementById(a).children[1];e.id==a&&updateTextarea(t,a)})}function updateTextarea(e,n){e.addEventListener("input",a=>{taskContent.forEach((e,t)=>{e.id==n&&(a.target.value.trim().length?taskContent[t].modifyText=a.target.value:deleteTask(n))})}),e.addEventListener("blur",a=>{taskContent.forEach((e,t)=>{e.id==n&&(a.target.value.trim().length?taskContent[t].modifyText=a.target.value:deleteTask(n))})})}function modifyTag(s){taskContent.forEach((e,t)=>{let a;var n=document.getElementById(s).firstElementChild;switch(e.id==s&&(2==(a=taskContent[t].getTag)?a=0:a++,taskContent[t].modifyTag=a),a){case 0:n.classList.remove("red"),n.classList.add("green"),n.textContent="Deseable";break;case 1:n.classList.remove("green"),n.classList.add("oranje"),n.textContent="Importante";break;case 2:n.classList.remove("oranje"),n.classList.add("red"),n.textContent="Urgente"}})}function taskCompleted(a){if(document.getElementById(a).lastElementChild.classList.contains("checked")){for(document.getElementById(a).remove();document.querySelector(".contenedor-tareas").firstElementChild;)document.querySelector(".contenedor-tareas").removeChild(document.querySelector(".contenedor-tareas").firstElementChild);resetTaskBox(),taskContent.forEach((e,t)=>{e.id==a&&(taskContent[t].modifyCheck=""),""==e.check&&taskContent[t].createHTML()})}else{for(document.getElementById(a).remove();document.querySelector(".contenedor-completadas").firstElementChild;)document.querySelector(".contenedor-completadas").removeChild(document.querySelector(".contenedor-completadas").firstElementChild);resetTaskBox(),taskContent.forEach((e,t)=>{e.id==a&&(taskContent[t].modifyCheck="checked"),"checked"==e.check&&taskContent[t].createHTML()})}hideMessage(".any-task",taskContain),hideMessage(".any-completed",completedContain)}function deleteAllTask(){let e="",t="";for(t=document.querySelector(".contenedor-tareas").classList.contains("hidde")?(e=document.querySelector(".contenedor-completadas"),"checked"):(e=document.querySelector(".contenedor-tareas"),"");e.firstElementChild;)e.removeChild(e.firstElementChild);hideMessage(".any-task",taskContain),hideMessage(".any-completed",completedContain),taskContent=taskContent.filter(e=>e.check!=t),iteradorTaskContent=taskContent.length,saveData()}function resetTaskBox(){let e="";for(e=document.querySelector(".contenedor-tareas").classList.contains("hidde")?document.querySelector(".contenedor-tareas"):document.querySelector(".contenedor-completadas");e.firstElementChild;)e.removeChild(e.firstElementChild)}function saveData(){localStorage.setItem("taskContent",JSON.stringify(taskContent))}function chargeData(){return JSON.parse(localStorage.getItem("taskContent"))}function hideMessage(e,t){var a=document.createElement("p");a.classList.add(e),0==t.children.length?(".any-task"==e?(a.textContent="No existen tareas pendientes...",a.classList.add("any-task")):(a.textContent="No tienes tareas completadas...",a.classList.add("any-completed")),t.appendChild(a)):1<t.children.length&&t.firstElementChild.classList.contains(e)&&t.removeChild(t.firstElementChild)}function changeTask(){var e=document.querySelector(".tareas"),t=document.querySelector(".completadas"),a=document.querySelector(".contenedor-tareas"),n=document.querySelector(".contenedor-completadas");e.classList.toggle("toggle-active"),t.classList.toggle("toggle-active"),a.classList.toggle("hidde"),n.classList.toggle("hidde")}addEventListener("DOMContentLoaded",startApp),taskBox.addEventListener("keypress",pressEnter),document.addEventListener("keypress",focusEvent),btnAgregar.addEventListener("click",createTask),taskContain.addEventListener("click",modifytaskBox),completedContain.addEventListener("click",modifytaskBox),btnToggle.addEventListener("click",changeTask),deleteTasks.addEventListener("click",deleteAllTask);class Task{constructor(e,t=0,a="",n=(new Date).getTime()){this.text=e,this.tag=t,this.check=a,this.id=n}set modifyText(e){this.text=e}set modifyCheck(e){this.check=e}set modifyTag(e){this.tag=e}get getTag(){return this.tag}createHTML(){var e=document.createElement("div"),t=(e.classList.add("container-task"),e.id=this.id,document.createElement("textarea")),a=(t.classList.add("card-task"),t.id="card-task",t.textContent=this.text,document.createElement("button"));switch(a.classList.add("tag"),a.id="tag",this.tag){case 0:a.classList.remove("red"),a.classList.add("green"),a.textContent="Deseable";break;case 1:a.classList.remove("green"),a.classList.add("oranje"),a.textContent="Importante";break;case 2:a.classList.remove("oranje"),a.classList.add("red"),a.textContent="Urgente"}var n=document.createElement("i"),s=(n.className="icon-close icon",n.setAttribute("id","icon-close"),document.createElement("div")),o=(s.className="boton-check icon "+this.check,s.setAttribute("id","boton-check"),document.createElement("i"));o.classList="icon-check",o.id="icon-check",s.appendChild(o),e.appendChild(a),e.appendChild(t),e.appendChild(n),e.appendChild(s),"checked"==this.check?(completedContain.appendChild(e),t.disabled=!0,a.disabled=!0):(taskContain.appendChild(e),t.disabled=!1,a.disabled=!1)}}